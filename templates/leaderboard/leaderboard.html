{% extends "base/base.html" %}
{% load static %}
{% block title %} OnlyForStudents Leaderboard {% endblock title %}
{% block css %}
<style>
  :root {
    --color-primary: #0a0a4d;
    --color-secondary: #1e3a8a;
    --color-accent: #10b981;
    --color-surface: #f8fafc;
    --color-background: #ffffff;
    --color-text-primary: #1f2937;
    --color-text-secondary: #6b7280;
    --color-border: #eef2f9;
    --shadow-md: 0 8px 25px rgba(0, 0, 0, 0.07);
  }

  body {
    background-color: var(--color-surface) !important;
    font-family: 'Inter', Arial, sans-serif;
  }

  .card {
    border-radius: 1.25rem;
    border: none;
    box-shadow: var(--shadow-md);
  }

  /* --- Profile Card --- */
  .profile-img {
    width: 100px;
    height: 100px;
    border-radius: 1rem;
    object-fit: cover;
    border: 4px solid var(--color-background);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  }

  .profile-level {
    position: absolute;
    bottom: -5px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--color-primary);
    color: #fff;
    border-radius: 50%;
    font-size: .9rem;
    font-weight: 700;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid var(--color-background);
  }

  .progress-bar {
    background-color: var(--color-accent) !important;
    border-radius: 8px;
  }

  /* --- Table and Badges --- */
  .mini-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
  }

  .role-badge {
    font-weight: 500;
    font-size: .9rem;
    padding: .4em 1em;
    border-radius: 2rem;
    background-color: #f0f5ff !important;
    color: var(--color-secondary) !important;
  }

  .badge-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 4px;
    background-color: #d1d5db;
    /* Default color */
  }

  /* Decorative dots in user card */
  .badge-color {
    width: 24px;
    height: 24px;
    border-radius: 50%;
  }

  .bg-yellow {
    background-color: #facc15 !important;
  }

  .bg-green {
    background-color: var(--color-accent) !important;
  }

  .bg-purple {
    background-color: #a78bfa !important;
  }

  .bg-light {
    background-color: #f0f5ff !important;
  }

  /* --- Sidebar --- */
  .sidebar-card-content {
    background: var(--color-surface);
    border-radius: 1rem;
  }

  .badge-rect {
    width: 28px;
    height: 28px;
    border-radius: 0.5rem;
  }

  .btn-primary {
    background-color: var(--color-primary) !important;
    border-color: var(--color-primary) !important;
    font-weight: 600;
    transition: all 0.2s ease;
  }

  .btn-primary:hover {
    background-color: var(--color-secondary) !important;
    border-color: var(--color-secondary) !important;
    transform: translateY(-2px);
  }

  .show-more-btn {
    background: #f0f5ff;
    color: var(--color-primary);
    border: none;
    border-radius: 0.6rem;
    font-size: 0.95rem;
    font-weight: 600;
    padding: 0.6rem 2rem;
    cursor: pointer;
    margin: 1rem auto 0 auto;
    display: block;
    transition: all .2s ease;
  }

  .show-more-btn:hover {
    background: var(--color-primary);
    color: #fff;
  }

  /* --- General Text & Links --- */
  h5,
  .h5 {
    color: var(--color-primary);
  }

  .text-primary {
    color: var(--color-primary) !important;
  }

  .text-muted {
    color: var(--color-text-secondary) !important;
  }

  @media (max-width:991.98px) {
    .profile-img {
      width: 96px !important;
      height: 96px !important;
    }

    .profile-level {
      width: 22px;
      height: 22px;
      font-size: .75rem;
    }

    .mini-avatar {
      width: 32px;
      height: 32px;
    }
  }
</style>
{% endblock css %}

{% block body %}

<!-- Main Content -->
<div class="container-xl my-4">
  <div class="text-center mb-5">
    <h1 class="fw-bolder" style="color: var(--color-primary);">Leaderboard</h1>
    <p class="text-muted fs-5">See where you stand among the top student developers.</p>
  </div>
  <div class="row g-4">
    <div class="col-lg-8">
      <!-- Profile Card -->
      <div class="card p-4 mb-4 shadow-sm">
        <div class="d-flex align-items-center flex-wrap">
          <div class="position-relative me-3 mb-3 mb-md-0">
            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Alex Johnson" class="profile-img">
            <span class="profile-level">23</span>
          </div>
          <div class="flex-grow-1">
            <h5 class="mb-0 fw-bold">Alex Johnson</h5>
            <a href="#" class="text-decoration-none text-primary fw-semibold small">Frontend Developer</a>
            <div class="text-muted small mt-1">Rank #23 out of 1,500 students</div>
            <div class="mt-3 d-flex gap-2">
              <span class="badge-color bg-yellow"></span>
              <span class="badge-color bg-green"></span>
              <span class="badge-color bg-purple"></span>
              <span class="badge-color bg-light"></span>
            </div>
          </div>
          <div class="ms-auto text-end">
            <div class="fs-3 fw-bold text-primary">2,450 XP</div>
            <div class="text-muted small">Level 12</div>
            <div class="progress mt-2" style="height: 6px; width: 150px;">
              <div class="progress-bar bg-primary" style="width: 66%"></div>
            </div>
          </div>
        </div>
      </div>
      <!-- Top Performers Card -->
      <div class="card p-4 shadow-sm">
        <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap">
          <h5 class="fw-bold mb-0">Top Performers</h5>
          <div class="d-flex align-items-center gap-2">
            <select class="form-select form-select-sm" style="width:120px;">
              <option>All Roles</option>
              <option>Frontend</option>
              <option>Backend</option>
              <option>Full Stack</option>
            </select>
            <button class="btn btn-light btn-sm px-3 fw-semibold">Sort by XP</button>
          </div>
        </div>
        <div class="table-responsive">
          <table class="table align-middle mb-0">
            <thead>
              <tr>
                <th class="text-muted small">Rank</th>
                <th class="text-muted small">Student</th>
                <th class="text-muted small">Role</th>
                <th class="text-muted small">XP Points</th>
                <th class="text-muted small">Badges</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="fw-bold fs-5">1</td>
                <td>
                  <div class="d-flex align-items-center">
                    <img src="https://randomuser.me/api/portraits/women/44.jpg" class="mini-avatar me-2"
                      alt="Sarah Chen">
                    <div>
                      <div class="fw-semibold">Sarah Chen</div>
                      <div class="small text-muted">Level 18</div>
                    </div>
                  </div>
                </td>
                <td>
                  <span class="badge rounded-pill role-badge bg-purple-light">Full Stack</span>
                </td>
                <td class="fw-bold text-primary">4,280 XP</td>
                <td>
                  <span class="badge-dot bg-yellow"></span>
                  <span class="badge-dot bg-green"></span>
                  <span class="badge-dot bg-purple"></span>
                </td>
              </tr>
              <tr>
                <td class="fw-bold fs-5">2</td>
                <td>
                  <div class="d-flex align-items-center">
                    <img src="https://randomuser.me/api/portraits/men/45.jpg" class="mini-avatar me-2"
                      alt="Marcus Rodriguez">
                    <div>
                      <div class="fw-semibold">Marcus Rodriguez</div>
                      <div class="small text-muted">Level 16</div>
                    </div>
                  </div>
                </td>
                <td>
                  <span class="badge rounded-pill role-badge bg-blue-light">Backend</span>
                </td>
                <td class="fw-bold text-primary">3,950 XP</td>
                <td>
                  <span class="badge-dot bg-red"></span>
                  <span class="badge-dot bg-green"></span>
                  <span class="badge-dot bg-yellow"></span>
                </td>
              </tr>
              <tr>
                <td class="fw-bold fs-5">3</td>
                <td>
                  <div class="d-flex align-items-center">
                    <img src="https://randomuser.me/api/portraits/women/47.jpg" class="mini-avatar me-2"
                      alt="Emily Watson">
                    <div>
                      <div class="fw-semibold">Emily Watson</div>
                      <div class="small text-muted">Level 15</div>
                    </div>
                  </div>
                </td>
                <td>
                  <span class="badge rounded-pill role-badge bg-green-light">Frontend</span>
                </td>
                <td class="fw-bold text-primary">3,720 XP</td>
                <td>
                  <span class="badge-dot bg-purple"></span>
                  <span class="badge-dot bg-blue"></span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- Show More Students Button -->
        <button class="show-more-btn" onclick="location.href='/leaderboard/all-students';">Show More Students</button>
      </div>
    </div>
    <!-- Right Aside -->
    <div class="col-lg-4">
      <div class="d-flex flex-column gap-4 h-100">
        <!-- Progress Card -->
        <div class="card p-4 shadow-sm">
          <h6 class="fw-bold mb-3">Your Progress</h6>
          <div class="bg-beige rounded-3 p-3 d-flex justify-content-between align-items-center mb-3">
            <span class="fw-semibold">15 Day Streak<br><span class="text-muted fw-normal small">Keep it
                up!</span></span>
            <span class="fs-4">ðŸ”¥</span>
          </div>
          <div class="small text-muted mb-1">Next Level Progress</div>
          <div class="d-flex align-items-center mb-2">
            <div class="progress flex-grow-1" style="height:8px;">
              <div class="progress-bar bg-primary" style="width: 75%"></div>
            </div>
            <span class="ms-2 fw-semibold small">750/1000 XP</span>
          </div>
        </div>
        <!-- Badge Collection Card -->
        <div class="card p-4 shadow-sm">
          <h6 class="fw-bold mb-3">Badge Collection</h6>
          <div class="d-flex flex-wrap gap-1 mb-2">
            <span class="badge-rect bg-yellow"></span>
            <span class="badge-rect bg-green"></span>
            <span class="badge-rect bg-purple"></span>
            <span class="badge-rect bg-red"></span>
            <span class="badge-rect bg-light"></span>
            <span class="badge-rect bg-light"></span>
            <span class="badge-rect bg-light"></span>
            <span class="badge-rect bg-light"></span>
          </div>
          <div class="small text-muted">4 of 12 badges earned</div>
        </div>
        <!-- Earn More XP Button -->
        <button class="btn btn-primary btn-lg fw-bold shadow-sm w-100 mt-auto" style="height:56px;">
          Earn More XP
        </button>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Toggle Weekly/All-time button
  document.addEventListener('DOMContentLoaded', function () {
    const weeklyBtn = document.getElementById('weeklyBtn');
    const allTimeBtn = document.getElementById('allTimeBtn');
    if (weeklyBtn && allTimeBtn) {
      weeklyBtn.addEventListener('click', function () {
        weeklyBtn.classList.add('active', 'btn-primary');
        allTimeBtn.classList.remove('active', 'btn-primary');
        allTimeBtn.classList.add('btn-light');
      });
      allTimeBtn.addEventListener('click', function () {
        allTimeBtn.classList.add('active', 'btn-primary');
        weeklyBtn.classList.remove('active', 'btn-primary');
        weeklyBtn.classList.add('btn-light');
      });
    }
  });
</script>
{% endblock %}